#!/bin/bash

if [ -z "$1" ]
then
    echo "error: missing exec path"
    exit 1
fi

APP_PATH="$1"
APP_NAME="$(basename $APP_PATH)"
DATA_PATH="${HOME}/data"

echo "rr-exec: running ${APP_NAME} (data path: ${DATA_PATH}/${APP_NAME})"

if [ ! -d "${DATA_PATH}/${APP_NAME}" ] 
then
  mkdir -p "${DATA_PATH}/${APP_NAME}"
fi

# cache and such
export XDG_CACHE_HOME=${HOME}/.cache
export XDG_RUNTIME_DIR=${HOME}/.runtime

# app data
export XDG_DATA_HOME="${DATA_PATH}"
export XDG_CONFIG_HOME="${DATA_PATH}"
export HOME="${DATA_PATH}/${APP_NAME}"

export SDL_VIDEODRIVER="kmsdrm"
export SDL_AUDIODRIVER="pulse"

exec ${APP_PATH}
